# Data Schemas
## Complete Field Definitions

**Source:** Extracted from `flowhub-core/backend/src/models/Item.js`

---

## Item Model Schema

### Core Fields

| Field | Type | Required | Constraints |
|-------|------|----------|-------------|
| `name` | String | ✅ Yes | 3-100 chars, alphanumeric + spaces/hyphens/underscores |
| `description` | String | ✅ Yes | 10-500 chars |
| `item_type` | Enum | ✅ Yes | `PHYSICAL` \| `DIGITAL` \| `SERVICE` |
| `price` | Number | ✅ Yes | 0.01-999999.99, rounded to 2 decimals |
| `category` | String | ✅ Yes | 1-50 chars |
| `tags` | Array[String] | ❌ No | Max 10, each 1-30 chars, unique |

### Conditional Fields (based on `item_type`)

#### PHYSICAL Items

| Field | Type | Required | Constraints |
|-------|------|----------|-------------|
| `weight` | Number | ✅ Yes (if PHYSICAL) | > 0 |
| `dimensions` | Object | ✅ Yes (if PHYSICAL) | - |
| `dimensions.length` | Number | ✅ Yes (if PHYSICAL) | > 0 |
| `dimensions.width` | Number | ✅ Yes (if PHYSICAL) | > 0 |
| `dimensions.height` | Number | ✅ Yes (if PHYSICAL) | > 0 |

#### DIGITAL Items

| Field | Type | Required | Constraints |
|-------|------|----------|-------------|
| `download_url` | String | ✅ Yes (if DIGITAL) | Valid URL |
| `file_size` | Number | ✅ Yes (if DIGITAL) | >= 1 |

#### SERVICE Items

| Field | Type | Required | Constraints |
|-------|------|----------|-------------|
| `duration_hours` | Number | ✅ Yes (if SERVICE) | >= 1 |

### Optional Fields

| Field | Type | Required | Constraints |
|-------|------|----------|-------------|
| `embed_url` | String | ❌ No | Valid HTTP/HTTPS URL |
| `file_path` | String | ❌ No | File upload path |
| `file_metadata` | Object | ❌ No | File info (original_name, content_type, size, uploaded_at) |

### Metadata Fields (Auto-managed)

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `created_by` | ObjectId | Auto-set | User ID from authenticated request |
| `is_active` | Boolean | `true` | Active status |
| `version` | Number | `1` | Auto-incremented on update (optimistic locking) |
| `deleted_at` | Date | `null` | Set on soft delete |
| `createdAt` | Date | Auto-generated | Creation timestamp |
| `updatedAt` | Date | Auto-generated | Last update timestamp |

### Internal Fields (NOT returned in API responses)

- `normalizedName` (String, auto-generated)
- `normalizedCategory` (String, auto-generated)
- `normalizedNamePrefix` (String, auto-generated)
- `__v` (Mongoose version key)

---

## Backend Defaults

- `is_active`: Defaults to `true`
- `version`: Defaults to `1`
- `deleted_at`: Defaults to `null`
- `normalizedName`, `normalizedCategory`: Auto-generated by pre-save hook

---

## Test Data Identification

### Recommended Methods

1. **Tags Field:**
   ```json
   {
     "tags": ["seed"]
   }
   ```

2. **Created By:**
   - Use `created_by` field to identify test data by user

### Safe Deletion

- Direct MongoDB deletion is safe for test environments
- No cascading deletes in code
- Related collections (`activitylogs`, `bulkjobs`) are NOT deleted when items are deleted

---

## Minimal Valid Payload Example

### DIGITAL Item (Simplest)

```json
{
  "name": "Test Item",
  "description": "This is a test item description that meets the minimum length requirement of 10 characters.",
  "item_type": "DIGITAL",
  "price": 10.00,
  "category": "Electronics",
  "download_url": "https://example.com/file.zip",
  "file_size": 1024
}
```

### PHYSICAL Item

```json
{
  "name": "Test Physical Item",
  "description": "This is a test physical item description that meets the minimum length requirement of 10 characters.",
  "item_type": "PHYSICAL",
  "price": 10.00,
  "category": "Electronics",
  "weight": 1.0,
  "dimensions": {
    "length": 10.0,
    "width": 5.0,
    "height": 2.0
  }
}
```

### SERVICE Item

```json
{
  "name": "Test Service Item",
  "description": "This is a test service item description that meets the minimum length requirement of 10 characters.",
  "item_type": "SERVICE",
  "price": 10.00,
  "category": "Electronics",
  "duration_hours": 1
}
```

---

**End of Data Schemas**
